all: src

PREFIX=@prefix@
VERSION=@PACKAGE_VERSION@
NAME=@PACKAGE_NAME@

qtmib_prefix.h:
	echo "#define QTMIB_PREFIX \"$(PREFIX)\"" > qtmib_prefix.h

.PHONY: src
src: qtmib_prefix.h
	$(MAKE) -C $@ $(MFLAGS)

clean:;rm -f build/*; make -C src/qtmib clean

distclean: clean
	rm -f `find src/qtmib -name Makefile`
	rm -f qtmib_config.h Makefile config.status config.log qtmib_prefix.h
	rm -fr autom4te.cache
	
install: all
	cd build; strip *; cd ..
	mkdir -p $(PREFIX)/bin
	mkdir -p $(PREFIX)/share/qtmib
	mkdir -p $(PREFIX)/share/applications
	mkdir -p $(PREFIX)/share/pixmaps
	mkdir -p $(PREFIX)/share/doc/qtmib
	install -c -m 0755 build/qtmib $(PREFIX)/bin/.
	install -c -m 0644 src/qtmib/qtmib.desktop $(PREFIX)/share/applications/.
	install -c -m 0644 src/art/qtmib-128.png $(PREFIX)/share/pixmaps/qtmib.png
	install -c -m 0644 COPYING $(PREFIX)/share/doc/qtmib/.
	install -c -m 0644 README $(PREFIX)/share/doc/qtmib/.
	install -c -m 0644 RELNOTES $(PREFIX)/share/doc/qtmib/.
	install -c -m 0644 src/mibs/* $(PREFIX)/share/qtmib/.

uninstall:;
	rm -f $(PREFIX)/bin/qtmib
	rm -f $(PREFIX)/share/pixmaps/qtmib.png
	rm -f $(PREFIX)/share/applications/qtmib.desktop
	rm -fr $(PREFIX)/share/qtmib
	rm -fr $(PREFIX)/share/doc/qtmib

dist: distclean
	./mkdist.sh $(NAME) $(VERSION)

ubuntu: dist
	./mkubuntu.sh $(NAME) $(VERSION)

	
	